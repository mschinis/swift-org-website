I"õ+<p>Iâ€™m excited to announce a new open-source package and an enhancement to the Swift Evolution process: the <a href="https://github.com/apple/swift-standard-library-preview">Standard Library Preview package</a>! The preview package provides access to functionality that has been accepted into the Swift standard library through the <a href="https://github.com/apple/swift-evolution/blob/master/process.md">Swift Evolution process</a>, but has not yet shipped as part of an official Swift release. This will allow us to incorporate feedback informed by real-world usage and remove many of the technical obstacles to contributing to the standard library.</p>

<p>Weâ€™ve seeded the preview package with the functionality from the recently approved <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0270-rangeset-and-collection-operations.md">SE-0270</a> proposal, which includes operations on subranges of collections, such as <code class="language-plaintext highlighter-rouge">subranges(where:)</code> and <code class="language-plaintext highlighter-rouge">moveSubranges(_:to:)</code>, as well as the supporting <code class="language-plaintext highlighter-rouge">RangeSet</code> type.</p>

<blockquote>
  <p><strong>Note</strong>: The Standard Library Preview package itself is a product of the Swift Evolution process! For more information, including the criteria for inclusion in the preview package, see <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0264-stdlib-preview-package.md">SE-0264</a>.</p>
</blockquote>

<h2 id="using-the-preview-package">Using the Preview Package</h2>

<p>To use the Standard Library Preview package in a Swift Package Manager project, add it to your <code class="language-plaintext highlighter-rouge">Package.swift</code> file as a package dependency and a target dependency:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">package</span> <span class="o">=</span> <span class="kt">Package</span><span class="p">(</span>
    <span class="nv">name</span><span class="p">:</span> <span class="s">"MyPackage"</span><span class="p">,</span>
    <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
       <span class="o">.</span><span class="nf">package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/apple/swift-standard-library-preview.git"</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="s">"0.0.1"</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="nv">targets</span><span class="p">:</span> <span class="p">[</span>
        <span class="o">.</span><span class="nf">target</span><span class="p">(</span>
            <span class="nv">name</span><span class="p">:</span> <span class="s">"MyTarget"</span><span class="p">,</span>
            <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="nf">product</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"StandardLibraryPreview"</span><span class="p">,</span> <span class="nv">package</span><span class="p">:</span> <span class="s">"swift-standard-library-preview"</span><span class="p">)]),</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div></div>

<p>â€¦ and take SE-0270 for a spin:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">StandardLibraryPreview</span>

<span class="k">var</span> <span class="nv">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">negatives</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="nf">subranges</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">})</span>
<span class="c1">// numbers[negatives].count == 3</span>

<span class="n">numbers</span><span class="o">.</span><span class="nf">moveSubranges</span><span class="p">(</span><span class="n">negatives</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">// numbers == [-5, -3, -9, 10, 12, 14, 15]</span>
</code></pre></div></div>

<p>As new additions to the standard library are approved, theyâ€™ll be added to the preview package as part of the Swift Evolution process.</p>

<p>Even though all additions go through a thorough review, <em>there is no substitute for feedback informed by real-world usage</em>. Sometimes we discover that an API is not quite as good as it might have been. The preview package will help us address such discoveries, by creating an opportunity for feedback to lead to changes before APIs are locked in and shipped in an official Swift release.</p>

<h2 id="using-standalone-packages">Using Standalone Packages</h2>

<p>The Standard Library Preview package is under continuous development, and maintains a major version of <code class="language-plaintext highlighter-rouge">0</code> to indicate that it is not intended to be source stable. If you require source stability in your project, each approved standard library proposal is also available as a standalone package. The preview package is actually an umbrella library, which re-exports each of these individual packages.</p>

<p>For example, the functionality for SE-0270 is available as the standalone <a href="https://github.com/apple/swift-se0270-range-set/">SE0270_RangeSet</a> package. So if you only ever want SE-0270, you can add it to your <code class="language-plaintext highlighter-rouge">Package.swift</code> file as a package dependency and a target dependency:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">package</span> <span class="o">=</span> <span class="kt">Package</span><span class="p">(</span>
    <span class="nv">name</span><span class="p">:</span> <span class="s">"MyPackage"</span><span class="p">,</span>
    <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
       <span class="o">.</span><span class="nf">package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/apple/swift-se0270-range-set.git"</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="s">"1.0.0"</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="nv">targets</span><span class="p">:</span> <span class="p">[</span>
        <span class="o">.</span><span class="nf">target</span><span class="p">(</span>
            <span class="nv">name</span><span class="p">:</span> <span class="s">"MyTarget"</span><span class="p">,</span>
            <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="nf">product</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"SE0270_RangeSet"</span><span class="p">,</span> <span class="nv">package</span><span class="p">:</span> <span class="s">"swift-se0270-range-set"</span><span class="p">)]),</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div></div>

<p>â€¦ and import just SE-0270:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SE0270_RangeSet</span>

<span class="k">var</span> <span class="nv">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">negatives</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="nf">subranges</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">})</span>
<span class="c1">// numbers[negatives].count == 3</span>

<span class="n">numbers</span><span class="o">.</span><span class="nf">moveSubranges</span><span class="p">(</span><span class="n">negatives</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">// numbers == [-5, -3, -9, 10, 12, 14, 15]</span>
</code></pre></div></div>

<h2 id="proposing-as-a-package">Proposing as a Package</h2>

<p>We require each standard library feature proposal to include a full implementation before the review process begins. However, we realize that not everyone has the time and resources to build the whole stackâ€”including LLVM, Clang, and the Swift compilerâ€”just to change a part of the standard library.</p>

<p>Going forward, you can provide your implementation as a standalone SwiftPM package by opening a pull request against the new <a href="https://github.com/apple/swift-evolution-staging">Swift Evolution staging</a> repository. This more approachable way of proposing a feature should eliminate many of the technical obstacles to contributing to the standard library.</p>

<p>Once a proposal is approved, it will be made available as part of the Standard Library Preview package in order to garner feedback before being included in an official Swift release.</p>

<h2 id="get-involved">Get Involved!</h2>

<p>If youâ€™re interested in participating in the review process and determining the direction of Swift, please visit the <a href="https://forums.swift.org/c/evolution">Evolution section of the Swift forums</a>. Everyone is welcome to propose, discuss, and review ideas to improve the Swift language and standard library!</p>

<h3 id="questions">Questions?</h3>

<p>Please feel free to post questions about this post on the <a href="https://forums.swift.org/t/swift-org-blog-standard-library-preview-package/33916">associated thread</a> on the <a href="https://forums.swift.org">Swift forums</a>.</p>

:ET