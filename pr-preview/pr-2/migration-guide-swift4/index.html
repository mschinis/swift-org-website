<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Swift.org - Migrating to Swift 4</title>
  <meta name="author" content="Apple Inc." />
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <link rel="license" href="/LICENSE.txt" />
  <link rel="stylesheet" media="all" href="/assets/stylesheets/application.css" />
  <link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64" type="image/vnd.microsoft.icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png" />
  <link rel="mask-icon" href="/assets/images/icon-swift.svg" color="#F05339" />
  

  
  <link rel="canonical" href="https://swift.org/migration-guide-swift4/" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@SwiftLang" />
  
  <meta name="twitter:title" content="Swift.org" />
  <meta name="twitter:description" content="Swift is a general-purpose programming language built using a modern approach to safety, performance, and software design patterns." />
  

  <meta property="og:site_name" content="Swift.org" />
  <meta property="og:image" content="https://swift.org/apple-touch-icon-180x180.png" />
  
  
  <meta property="og:title" content="Swift.org" />
  <meta property="og:url" content="https://swift.org" />
  <meta property="og:description" content="Swift is a general-purpose programming language built using a modern approach to safety, performance, and software design patterns." />
  
</head>

<body>
<script src="/assets/javascripts/color-scheme-toggle.js"></script>
<nav role="navigation">
  <div class="nav-menu-container">
    <header class="menu-item logo-container" role="banner">
      <h1 id="logo">
        <a href="/" title="Swift.org" role="img" aria-label="Swift.org">
          Swift.org
        </a>
      </h1>
    </header>
    <div id="menu-toggle" class="menu-item menu-toggle open"></div>
  </div>

  <div class="list-items">
    
    
    <ul>
      
      
      <li>
      
        <a href="/about/">About Swift</a>
        
      </li>
      
      
      <li>
      
        <a href="/blog/">Blog</a>
        
      </li>
      
      
      <li>
      
        <a href="/getting-started/">Getting Started</a>
        
      </li>
      
      
      <li>
      
        <a href="/download/">Download</a>
        
      </li>
      
      
      <li>
      
        <a href="/platform-support/">Platform Support</a>
        
      </li>
      
      
      <li>
      
        <a href="/documentation/">Documentation</a>
        
      </li>
      
    </ul>
    
    
    <h2>Community</h2>
    
    <ul>
      
      
      <li>
      
        <a href="/community/">Community Overview</a>
        
      </li>
      
      
      <li>
      
        <a href="/diversity/">Diversity</a>
        
      </li>
      
      
      <li>
      
        <a href="/mentorship/">Mentorship</a>
        
      </li>
      
      
      <li>
      
        <a href="/contributing/">Contributing</a>
        
      </li>
      
      
      <li>
      
        <a href="/code-of-conduct/">Code of Conduct</a>
        
      </li>
      
    </ul>
    
    
    <h2>Open Source Development</h2>
    
    <ul>
      
      
      <li>
      
        <a href="/source-code/">Source Code</a>
        
      </li>
      
      
      <li>
      
        <a href="/continuous-integration/">Continuous Integration</a>
        
      </li>
      
      
      <li>
      
        <a href="/source-compatibility/">Source Compatibility</a>
        
      </li>
      
      
      <li>
      
        <a href="/support/security.html">Security</a>
        
      </li>
      
    </ul>
    
    
    <h2>Open Source Efforts</h2>
    
    <ul>
      
      
      <li>
      
        <a href="/swift-compiler/">Swift Compiler</a>
        
      </li>
      
      
      <li>
      
        <a href="/standard-library/">Standard Library</a>
        
      </li>
      
      
      <li>
      
        <a href="/package-manager/">Package Manager</a>
        
      </li>
      
      
      <li>
      
        <a href="/core-libraries/">Core Libraries</a>
        
      </li>
      
      
      <li>
      
        <a href="/lldb/">REPL, Debugger & Playgrounds</a>
        
      </li>
      
      
      <li>
      
        <a href="/server/">Swift on Server</a>
        
      </li>
      
      
      <li>
      
        <a href="/website/">Swift.org website</a>
        
      </li>
      
    </ul>
    
  </div>
</nav>

<main role="main">
  <article class="page">
  <header>
    <h1>Migrating to Swift 4</h1>
  </header>

  <p><strong>This is a legacy document for Xcode 9 and migrating from Swift 3.</strong></p>

<p>Xcode 9.0 comes with a Swift Migrator tool that helps you migrate your project to Swift 4.</p>

<h2 id="pre-migration-preparation">Pre-Migration Preparation</h2>

<p>Make sure that the project that you intend to migrate builds successfully in Swift 3.2 mode, and all its tests pass. Keep in mind that Swift 3.2 does have significant changes from 3.1, as well as the SDKs against which you built, so you may need to resolve errors initially.</p>

<p>It’s highly recommended to have your project managed under source control. This will allow you to easily review the changes that were applied via the migration assistant and to discard them and re-try the migration if needed.</p>

<p>Different from last year, the Migrator is built directly into the compiler and not a separate tool, so it can understand both Swift 3.2 and Swift 4 code equally and compile them together, just like the Swift 4 compiler can. That means you decide when and if you’d like to migrate on a per-target basis when it makes sense for your project. While migrating to Swift 4 is definitely encouraged, it’s not an all-or-nothing process, as Swift 3.2 and Swift 4 targets can coexist and link together.</p>

<p>The migration assistant does a <em>migrator build</em> to gather the changes, using the scheme you have selected, so the targets that will get processed are the ones that are included in the scheme. To review and modify what is included in the scheme, invoke the <em>Edit Scheme…</em> sheet and select the <em>Build</em> tab from the column on the left, and make sure all your targets and their unit tests are included.</p>

<blockquote>
  <p>If your project depends on other open-source projects that are provided by Carthage or CocoaPods, consult the <a href="#using-carthagecocoapods-projects">Using Carthage/CocoaPods Projects</a> section.</p>
</blockquote>

<h2 id="swift-migration-assistant">Swift Migration Assistant</h2>

<p>When you open your project with Xcode 9 for the first time, you will see a migration opportunity item in the Issue Navigator: click it to activate a sheet asking you if you’d like to migrate. You can be reminded later or invoke the Migrator manually from the menu <em>Edit -&gt; Convert -&gt; To Current Swift Syntax…</em></p>

<p>You will be presented with a list of targets to migrate. Targets that do not contain any Swift code will not be selected.</p>

<p>There is only one migration workflow this year, although there is a choice between two kinds of <em><code class="language-plaintext highlighter-rouge">@objc</code> Inference</em>:</p>

<ul>
  <li><strong>Minimize Inference</strong>: Add an @objc attribute to your code only where it is needed based on static inference. After using this option you need to follow the manual steps detailed in Completing a Swift 4 minimize inference migration to complete the conversion.</li>
  <li><strong>Match Swift 3 Behavior</strong>: Add an @objc attribute to your code anywhere it would be implicitly inferred by the compiler. This option does not change the size of your binary as it adds explicit @objc attributes everywhere they were implicitly added by Swift 3.</li>
</ul>

<blockquote>
  <p>For more information and implications of these two choices, see the Xcode Help article <a href="https://help.apple.com/xcode/mac/current/#/deve838b19a1">Migrate to Swift 4 <code class="language-plaintext highlighter-rouge">@objc</code> inference</a>.</p>
</blockquote>

<p>Clicking <em>Next</em> will bring up the <em>Generate Preview</em> sheet and the assistant will initiate a <em>migration build</em> to get source changes. When this is done, you will be presented with all the changes that will be applied once you click on ‘Save’. This will also change the <em>Swift Language Version</em> build setting for the migrated targets to <em>Swift 4</em>.</p>

<p>There may have been issues with processing the targets that will negatively impact the migration process. Switch to the <em>Report Navigator</em> and select the <em>Convert</em> entry that was added; this is the conversion build log. Check the log for errors that may have showed up.</p>

<p>If you see errors about not being able to code-sign the target, try disabling code-signing from the build settings of the target. If you see other errors, please <a href="https://bugreport.apple.com">file a bug report</a> and include the details. You are strongly encouraged to attach a project that illustrates the faulty migration if possible.</p>

<h2 id="swift-4-migration-changes-overview">Swift 4 Migration Changes Overview</h2>

<p>The vast majority of changes that the Migrator suggests comes from data generated by a comparison of the previous SDK and the current SDK, which may drive renaming of identifiers and types, for example; and from normal <em>compiler fix-its</em>. There are a few special provisions where the Migrator can safely perform straightforward mechanical changes.</p>

<h3 id="sdk-changes">SDK Changes</h3>

<p>The two most prevalent SDK changes are moving global constants into static type properties and transforming string constants into Swift enumeration cases. These are handled automatically by the Migrator. You’ll also see various type signature changes.</p>

<h3 id="notable-special-cases">Notable Special Cases</h3>

<h4 id="new-string">New String</h4>

<p><code class="language-plaintext highlighter-rouge">String</code> has new APIs in Swift 4, some of which now return <code class="language-plaintext highlighter-rouge">Substring</code> or <code class="language-plaintext highlighter-rouge">String</code>. To ease this transition, the Migrator will insert explicit initializer conversions when an API now expects a different type.</p>

<blockquote>
  <p>For more information about the new <code class="language-plaintext highlighter-rouge">String</code> and <code class="language-plaintext highlighter-rouge">Substring</code> APIs, see the <a href="https://github.com/apple/swift-evolution/blob/main/proposals/0163-string-revision-1.md">Swift Evolution Document for SE-0163</a>.</p>
</blockquote>

<h4 id="se-0110-distinguish-between-single-tuple-and-multiple-argument-function-types">SE-0110: Distinguish between single-tuple and multiple-argument function types</h4>

<p><strong><code class="language-plaintext highlighter-rouge">f: (Void) -&gt; ()</code></strong></p>

<p>When using <code class="language-plaintext highlighter-rouge">f: (Void) -&gt; ()</code> for the type of a function argument, it is generally meant to be <code class="language-plaintext highlighter-rouge">f: () -&gt; ()</code>, so the Migrator will suggest you use this type instead. Otherwise, with the new rules in SE-0110 for Swift 4, you would need to call the function <code class="language-plaintext highlighter-rouge">f</code> as <code class="language-plaintext highlighter-rouge">f(())</code>.</p>

<p><strong>Adding tuple destructuring</strong></p>

<p>For code such as:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">foo</span><span class="p">(</span><span class="nv">_</span><span class="p">:</span> <span class="p">((</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">())</span> <span class="p">{}</span>
<span class="n">foo</span> <span class="p">{</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">in</span> <span class="nf">print</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="p">}</span>
</code></pre></div></div>

<p>The Migrator must add explicit tuple destructuring to continue building in Swift 4, such as:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">foo</span><span class="p">(</span><span class="nv">_</span><span class="p">:</span> <span class="p">((</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">())</span> <span class="p">{}</span>
<span class="n">foo</span> <span class="p">{</span> <span class="k">let</span> <span class="p">(</span><span class="nv">x</span><span class="p">,</span> <span class="nv">y</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$0</span><span class="p">;</span> <span class="nf">print</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p>For more information about this language change, see the <a href="https://github.com/apple/swift-evolution/blob/main/proposals/0110-distingish-single-tuple-arg.md">Swift Evolution Document for SE-0110</a>.</p>
</blockquote>

<h4 id="default-parameter-values-must-be-public">Default parameter values must be public</h4>

<p>The compiler is now more strict about the accessiblity of referenced, non-literal values used as default arguments for your public functions; they must be also be <code class="language-plaintext highlighter-rouge">public</code>. Among other things, this exposes an opportunity for optimizing access to the value at the call site. Because this may involve API design, the Migrator does not suggest fixes, although there are some possibilities for you to consider as an API author:</p>

<ul>
  <li>Make the referenced default values <code class="language-plaintext highlighter-rouge">public</code>.</li>
  <li>Provide <code class="language-plaintext highlighter-rouge">public</code> functions which return a sensible default value.</li>
</ul>

<blockquote>
  <p>In both cases, consider the impact of exposing new API, making sure to document your public symbols.</p>
</blockquote>

<h2 id="after-migration">After Migration</h2>

<p>While the migrator will take care of many mechanical changes for you, it is likely that you will need to make more manual changes to be able to build the project after applying the migrator changes.</p>

<p>You may see compiler errors that have associated fixits; while the migrator is designed to incorporate fixits that the Swift 4 compiler provides, some fixits may not be applied if they are not applicable 100% of the time.</p>

<p>Even if it compiles fine, the code that the migrator provided may not be ideal. Use your best judgement and check that the changes are appropriate for your project.</p>

<h2 id="known-migration-issues">Known Migration Issues</h2>

<blockquote>
  <p>For information on the latest known issues for migration in Xcode 9, see the <em>Swift Migration</em> section of the Release Notes for Xcode 9 on the <a href="https://developer.apple.com/download/">Developer Downloads</a> page.</p>
</blockquote>

<h2 id="using-carthagecocoapods-projects">Using Carthage/CocoaPods Projects</h2>

<p>Here are some important points to consider when migrating a project with external dependencies using package managers like Carthage, CocoaPods, or the Swift Package Manager.</p>

<ul>
  <li>It is recommended to use source dependencies rather than binary Swift modules, because Swift 3.1 modules will not be compatible with Swift 3.2/4 modules, unless you can get distributions that were built in Swift 3.2 or Swift 4 mode.</li>
  <li>Make sure your source dependencies build successfully in Swift 3.2 mode as well as your own targets.</li>
  <li>If you have setup framework search paths for finding the binary Swift modules inside Carthage’s build folder, either remove the search paths or clean the build folder, so that you are sure that you are only using the Swift modules that are built from your Xcode workspace.</li>
  <li>It is not necessary to migrate your source dependencies as long as they can build in Swift 3.2 mode.</li>
</ul>

<h2 id="miscellaneous">Miscellaneous</h2>

<ul>
  <li>If you have multiple schemes in your project that cover different targets, you will only get notified that you need to migrate one of them.  You will need to manually select the new scheme, then run <em>Edit -&gt; Convert -&gt; To Current Swift Syntax</em> to migrate the remaining schemes. Or you can create a scheme that includes all the targets from your project, and have it selected before running the migration assistant.</li>
</ul>


</article>

</main>

<footer role="contentinfo">
  <div class="footer-content">
    
    <p class="copyright">Copyright © 2022 Apple Inc. All rights reserved.</p>
    <p class="trademark">Swift and the Swift logo are trademarks of Apple Inc.</p>
    <p class="privacy">
      <a href="//www.apple.com/privacy/privacy-policy/">Privacy Policy</a>
      <a href="//www.apple.com/legal/privacy/en-ww/cookies/">Cookies</a>
    </p>
  </div>
  <div class="footer-other">
    <form
      class="color-scheme-toggle"
      role="radiogroup"
      tabindex="0"
      id="color-scheme-toggle"
    >
      <legend class="visuallyhidden">Color scheme preference</legend>
      <label for="scheme-light">
        <input id="scheme-light" type="radio" name="color-scheme-preference" value="light">
        <span class="color-scheme-toggle-label">Light</span>
      </label>
      <label for="scheme-dark">
        <input id="scheme-dark" type="radio" name="color-scheme-preference" value="dark">
        <span class="color-scheme-toggle-label">Dark</span>
      </label>
      <label for="scheme-auto" id="scheme-auto-wrapper">
        <input id="scheme-auto" type="radio" name="color-scheme-preference" value="auto">
        <span class="color-scheme-toggle-label">Auto</span>
      </label>
    </form>
    <aside>
      <a href="https://twitter.com/swiftlang" rel="nofollow" title="Follow @SwiftLang on Twitter"><i class="twitter"></i></a>
      <a href="/atom.xml" title="Subscribe to Site Updates"><i class="feed"></i></a>
    </aside>
  </div>
</footer>


<script src="/assets/javascripts/application.js"></script>
<!-- metrics -->
<script>
    /* RSID: */
    var s_account="awdswiftorg"
</script>
<script src="https://developer.apple.com/assets/metrics/scripts/analytics.js"></script>
<script>
    s.pageName= AC && AC.Tracking && AC.Tracking.pageName();

    /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
    var s_code=s.t();if(s_code)document.write(s_code)
</script>
<!-- /metrics -->
</body>
</html>
